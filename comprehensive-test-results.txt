
======================================================================
ğŸš€ COMPREHENSIVE API ENDPOINT TEST SUITE V2
======================================================================

Testing against: http://localhost:3000
Started at: 10/2/2025, 10:17:45 PM

======================================================================
ğŸ”‘ AUTHENTICATION SETUP
======================================================================

ğŸ” Attempting to authenticate regular user...
âœ… Regular user authenticated successfully

ğŸ” Attempting to authenticate admin user...
âœ… Admin user authenticated successfully

======================================================================
ğŸ“Š HEALTH & READINESS CHECKS
======================================================================

ğŸ§ª [Health] Health endpoint
   âœ… GET /api/health - Status: healthy

ğŸ§ª [Health] Ping endpoint
   âœ… GET /api/ping - Pong received

ğŸ§ª [Health] Readiness endpoint
   âœ… GET /api/readiness - System ready

======================================================================
ğŸ” AUTHENTICATION ENDPOINTS
======================================================================

ğŸ§ª [Auth] Register endpoint - Duplicate user
   âœ… POST /api/auth/register - Duplicate user properly rejected

ğŸ§ª [Auth] Forgot password endpoint
   âœ… POST /api/auth/forgot-password - Password reset initiated

ğŸ§ª [Auth] Reset password endpoint - Invalid token
   âœ… POST /api/auth/reset-password - Invalid token properly rejected

======================================================================
ğŸ–ï¸  LEAVE MANAGEMENT ENDPOINTS
======================================================================

ğŸ§ª [Leave] Balance endpoint - No auth
   âœ… GET /api/leave/balance - Properly requires authentication (307)

ğŸ§ª [Leave] Balance endpoint - With auth
   âœ… GET /api/leave/balance - Balance retrieved

ğŸ§ª [Leave] Get leave requests
   âœ… GET /api/leave/requests - Found 0 requests

ğŸ§ª [Leave] Create leave request - Valid
   âœ… POST /api/leave/request - Request created

ğŸ§ª [Leave] Get leave request ID for testing
   â­ï¸ POST /api/leave/request/[id]/* - No leave requests to test with

======================================================================
ğŸ‘‘ ADMIN ENDPOINTS
======================================================================

ğŸ§ª [Admin] Stats endpoint - No auth
   âœ… GET /api/admin/stats - Properly requires authentication (307)

ğŸ§ª [Admin] Stats endpoint - Regular user
   âœ… GET /api/admin/stats - Admin access properly restricted

ğŸ§ª [Admin] Stats endpoint - Admin user
   âœ… GET /api/admin/stats - Stats retrieved

ğŸ§ª [Admin] Pending requests
   âœ… GET /api/admin/pending-requests - Found 0 pending

ğŸ§ª [Admin] Employee balances
   âœ… GET /api/admin/employee-balances - Found 0 employees

ğŸ§ª [Admin] Upcoming leave
   âœ… GET /api/admin/upcoming-leave - Found 3 upcoming

ğŸ§ª [Admin] Performance metrics
   âœ… GET /api/admin/performance - Metrics retrieved

ğŸ§ª [Admin] Bulk approve - Empty array
   âœ… POST /api/admin/bulk-approve - Empty array handled

ğŸ§ª [Admin] Bulk reject - Empty array
   âœ… POST /api/admin/bulk-reject - Empty array handled

ğŸ§ª [Admin] Get pending leave requests for admin testing
   â­ï¸ POST /api/leave/request/[id]/approve-reject - No pending requests to test with

ğŸ§ª [Admin] Get user for employee details testing
   â­ï¸ GET /api/admin/employee-details/[employeeId] - No users to test with

======================================================================
â° TOIL (TIME OFF IN LIEU) ENDPOINTS
======================================================================

ğŸ§ª [TOIL] Get TOIL balance
   âŒ GET /api/admin/toil - Failed: 403

ğŸ§ª [TOIL] Pending TOIL requests - Admin
   âœ… GET /api/admin/toil/pending - Found 0 pending TOIL

ğŸ§ª [TOIL] Approve TOIL - Invalid ID
   âŒ POST /api/admin/toil/approve - Unexpected: 422

======================================================================
ğŸ“… CALENDAR ENDPOINTS
======================================================================

ğŸ§ª [Calendar] Team calendar
   âœ… GET /api/calendar/team - Calendar data retrieved

ğŸ§ª [Calendar] Team leave calendar
   âœ… GET /api/calendar/team-leave - Found 0 entries

======================================================================
ğŸ”§ MISC ENDPOINTS
======================================================================

ğŸ§ª [Misc] Users endpoint - Regular user
   âœ… GET /api/users - Admin-only access properly enforced

ğŸ§ª [Misc] Metrics endpoint
   âŒ GET /api/metrics - Failed: 404

ğŸ§ª [Misc] Seed dummy data endpoint
   âœ… POST /api/admin/seed-dummy-data - Seeding works

ğŸ§ª [Misc] Comprehensive seed endpoint
   âœ… POST /api/admin/comprehensive-seed - Seeding works

======================================================================
ğŸ“Š TEST SUMMARY
======================================================================

âœ… Passed:   25/31
âŒ Failed:   3/31
âš ï¸  Warnings: 0/31
â­ï¸  Skipped:  3/31

ğŸ“ˆ Success Rate: 80.6%

âŒ Failed Tests:
   â€¢ GET /api/admin/toil - Failed: 403
   â€¢ POST /api/admin/toil/approve - Unexpected: 422
   â€¢ GET /api/metrics - Failed: 404

======================================================================
âš ï¸  Some tests failed. Please review the failures above.
======================================================================

